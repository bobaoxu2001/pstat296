setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
install.packages("GeneCycle")
install.packages("GeneCycle")
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(qpcR)
install.packages("GeneCycle")
install.packages("qpcR")
knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("index.csv)
data <- read.csv("index.csv")
data1 <- read.csv("index.csv")
data2 <- read.csv("inflation interest unemployment.csv")
data1
data2
knitr::opts_chunk$set(echo = TRUE)
data1 <- read.csv("data.csv")
data <- read.csv("data.csv")
data123 <- read.csv("data.csv")
data <- read.csv("data111.csv")
data <- read.csv("data111.csv")
data
train <- data[1:1000]
train <- data[1:1000,2]
test <- data[1001:1236,2]
train <- data[1:1000,2]
test <- data[1001:1236,2]
train
train <- data[1:1000,1,3]
test <- data[1001:1236,1,3]
train
knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("inflation interest unemployment.csv")
data
data <- read.csv("index.csv")
data
train <- data[1:850,7]
test <- data[851:904,7]
train
mydata <- ts(train, start=c(1955,1),frequency=12)
plot(mydata)
pred.tr <- sarima.for(train, n.ahead=6, plot,all=F, p=0 d=1, q=1, P=1, D=1, Q=1, S=12)
pred.tr <- sarima.for(train, n.ahead=6, plot,all=F, p=0 d=1, q=1, P=1, D=1, Q=1,S=12)
pred.tr <- sarima.for(train, n.ahead=6, plot,all=F, p=0 d=1, q=1, P=1, D=1, Q=1,S=12)
pred.tr <- sarima.for(train, n.ahead=6, plot,all=F, p=0 d=1, q=1, P=1, D=1, Q=1,S=12)
pred.tr <- sarima.for(train, n.ahead=6, plot,all=F, p=0 d=1, q=1, P=1, D=1, Q=1,S=12)
tsdata <- ts(mydata, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
data <- read.csv("data111.csv")
data
train <- data[1:1200,6]
test <- data[1201:1236,6]
train <- data[1:1200,6]
test <- data[1201:1236,6]
mydata <- ts(train, start=c(1920,1),frequency=12)
plot(mydata)
tsdata <- ts(mydata, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
train <- data[3:1200,6]
test <- data[1201:1236,6]
mydata <- ts(train, start=c(1920,1),frequency=12)
plot(mydata)
tsdata <- ts(mydata, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
tsdata <- ts(mydata, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
tsdata <- ts(mydata, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
tsdata <- ts(mydata, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
mydata <- ts(train, start=c(1920,1),frequency=12)
mydata
plot(mydata)
tsdata <- ts(mydata, frequency = 12)
df$net <- df$sales - as.numeric(df$returns)
tsdata <- ts(mydata, frequency = 12)
df$net <- df$sales - as.numeric(df$returns)
tsdata <- ts(mydata, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
tsdata <- ts(mydata, frequency = 12)
tsdata
tsdata
tsdata <- ts(mydata, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
tsdata <- ts(mydata, frequency = 12)
plot.ts(mydata)
tsdata <- ts(mydata, frequency = 12)
plot.ts(tsdata)
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/xuao/Documents/PSTAT296A/pstat296/")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(qpcR)
setwd("/Users/xuao/Documents/PSTAT296A/pstat296/")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
#library(qpcR)
#library(ggfortify)
library(tidyverse)
library(readxl)
library(ggplot2)
library(lubridate)
library(reshape2)
library(kableExtra)
TR26_21 <- read_excel("SBBI Data for Capital Markets (2022_10_21).xlsx", sheet =  "Processed")
setwd("/Users/xuao/Documents/PSTAT296A/pstat296/")
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
#library(qpcR)
#library(ggfortify)
library(tidyverse)
library(readxl)
library(ggplot2)
library(lubridate)
library(reshape2)
library(kableExtra)
rm(list = ls())
TR26_21 <- read_excel("SBBI Data for Capital Markets (2022_10_21).xlsx", sheet =  "Processed")
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
#library(qpcR)
#library(ggfortify)
library(tidyverse)
library(readxl)
library(ggplot2)
library(lubridate)
library(reshape2)
library(kableExtra)
TR26_21 <- read_excel("SBBI Data for Capital Markets (2022_10_21).xlsx", sheet =  "Processed")
TR26_21 <- read_excel("/Users/xuao/Documents/PSTAT296A/pstat296/SBBI Data for Capital Markets (2022_10_21).xlsx", sheet =  "Processed")
colnames(TR26_21) <- c("Observed Month", "Large Cap TR", "LT Govt TR 20 YR","IT Govt TR 5 YR","LT Corp TR 20 YR","T-Bill TR 30 DAY","US CPI/ INFLATION","LT Govt Yield 20 YEAR","IT Govt Yield 5 YEAR")
TR26_21 <- TR26_21 %>%
filter(!row_number() %in% c(1:5)) %>%
janitor::clean_names()
TR26_21 <- as.data.frame(sapply(TR26_21, as.numeric))
TR26_21 <- TR26_21 %>%
mutate(observed_month = as.Date(observed_month,origin = "1899-12-30"))
View(TR26_21)
View(TR26_21)
Govt_20_Yield <- TR26_21[,c(1,8)]
Govt_20_Yield$yield_percentage <- round(Govt_20_Yield$lt_govt_yield_20_year*100, digits = 3)
Govt_20_Yield <- TR26_21[,c(1,8)]
Govt_20_Yield$yield_percentage <- round(Govt_20_Yield$lt_govt_yield_20_year*100, digits = 3)
View(Govt_20_Yield)
View(Govt_20_Yield)
Govt_20_Yield <- TR26_21[,c(1,8)]
Govt_20_Yield$yield_percentage <- round(Govt_20_Yield$lt_govt_yield_20_year*100, digits = 3)
summary(Govt_20_Yield$yield_percentage)
summary(Govt_20_Yield$yield_percentage)
plot(Govt_20_Yield$yield_percentage)
tsdata <- ts(Govt_20_Yield$yield_percentage, frequency = 12)
ddata <- decompose(tsdata, "multiplicative")
plot(ddata)
plot(ddata$trend)
plot(ddata$seasonal)
plot(ddata$random)
plot(Govt_20_Yield$yield_percentage)
abline(reg=lm(Govt_20_Yield$yield_percentage~time(Govt_20_Yield$yield_percentage)))
ggplot(Govt_20_Yield$yield_percentage)
plot(Govt_20_Yield$yield_percentage)
abline(reg=lm(Govt_20_Yield$yield_percentage~time(Govt_20_Yield$yield_percentage)))
boxplot(Govt_20_Yield$yield_percentage~cycle(Govt_20_Yield$yield_percentage, xlab="Date", ylab = "Govt_20_Yield$yield_percentage", main = "Date"))
mymodel <- auto.arima(AirPassengers)
mymodel
mymodel <- auto.arima(Govt_20_Yield$yield_percentage)
mymodel
plot.ts(mymodel$residuals)
myforecast <- forecast(mymodel, level=c(95), h=10*12)
plot(myforecast)
train <- Govt_20_Yield$yield_percentage[889:1140]
test <- Govt_20_Yield$yield_percentage[1141:1152]
train <- Govt_20_Yield$yield_percentage[889:1140]
test <- Govt_20_Yield$yield_percentage[1141:1152]
train
train <- Govt_20_Yield$yield_percentage[889:1140]
test <- Govt_20_Yield$yield_percentage[1141:1152]
train
test
mydata <- ts(train, start=(2000,1),frequency=12)
mydata <- ts(train, start=(2000),frequency=12)
plot(mydata)
tsdata <- ts(train, frequency = 12)
ddata <- decompose(train, "multiplicative")
tsdata <- ts(train, frequency = 12)
ddata <- decompose(train)
tsdata <- ts(train, frequency = 12)
ts.plot(tsdata)
hist(tsdata, main="Histogram",
xlab="date")
# Box-Cox transformation:
t <- 1:length(wine)
# Box-Cox transformation:
t <- 1:length(tsdata)
bcTransform <- boxcox(tsdata ~ t, plotit=TRUE)
lambda <- bcTransform$x[which.max(bcTransform$y)]
tsdata.bc = (1/lambda)*(tsdataË†lambda-1)
lambda <- bcTransform$x[which.max(bcTransform$y)]
tsdata.bc = (1/lambda)*(tsdata^lambda-1)
# Plot and compare the two:
par(mfrow=c(1, 2))
ts.plot(tsdata, main = "Original data",ylab = expression(X[t]))
ts.plot(tsdata.bc, main = "Box-Cox tranformed data", ylab = expression(Y[t]))
lambda <- bcTransform$x[which.max(bcTransform$y)]
tsdata.bc = (1/lambda)*(tsdata^lambda-1)
# Plot and compare the two:
par(mfrow=c(1, 2))
ts.plot(tsdata, main = "Original data",ylab = expression(X[t]))
ts.plot(tsdata.bc, main = "Box-Cox tranformed data", ylab = expression(Y[t]))
lambda <- bcTransform$x[which.max(bcTransform$y)]
lambda
tsdata.bc = (1/lambda)*(tsdata^lambda-1)
# Plot and compare the two:
par(mfrow=c(1, 2))
ts.plot(tsdata, main = "Original data",ylab = expression(X[t]))
ts.plot(tsdata.bc, main = "Box-Cox tranformed data", ylab = expression(Y[t]))
histogram(tsdata.bc)
histgram(tsdata.bc)
hist(tsdata.bc)
# Deseasonlize:
y.12 <- diff(tsdata.bc, 12)
y.12.2 <- diff(y.12, 12)
var(y.12); var(y.12.2)
# Detrend:
y.1.12 <- diff(y.12, 1)
var(y.12); var(y.1.12)
# Plot it:
par(mfrow=c(1, 1))
ts.plot(y.12, main="De-seasonlized Time Series",
ylab=expression(nabla[12]~Y[t]))
abline(h=mean(y.12), lty=2)
par(mfrow=c(1, 2))
acf(y.12, lag.max=60, main=expression(nabla[12]~Y[t]))
pacf(y.12, lag.max=60, main=expression(nabla[12]~Y[t]))
acf(y.12, lag.max=12, main=expression(nabla[12]~Y[t]))
pacf(y.12, lag.max=12, main=expression(nabla[12]~Y[t]))
# Candidate models:
df <- expand.grid(p=0:1, q=0:1, P=0:2, Q=0:1)
df <- cbind(df, AICc=NA)
# Compute AICc:
for (i in 1:nrow(df)) {
sarima.obj <- NULL
try(arima.obj <- arima(wine.bc, order=c(df$p[i], 0, df$q[i]),
seasonal=list(order=c(df$P[i], 1, df$Q[i]), period=12),
method="ML"))
if (!is.null(arima.obj)) { df$AICc[i] <- AICc(arima.obj) }
# print(df[i, ])
}
install.packages(qpcR)
install.packages("qpcR")
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(qpcR)
install.packages("qpcR")
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(qpcR)
# Candidate models:
df <- expand.grid(p=0:1, q=0:1, P=0:2, Q=0:1)
df <- cbind(df, AICc=NA)
# Compute AICc:
for (i in 1:nrow(df)) {
sarima.obj <- NULL
try(arima.obj <- arima(wine.bc, order=c(df$p[i], 0, df$q[i]),
seasonal=list(order=c(df$P[i], 1, df$Q[i]), period=12),
method="ML"))
if (!is.null(arima.obj)) { df$AICc[i] <- AICc(arima.obj) }
# print(df[i, ])
}
# Candidate models:
df <- expand.grid(p=0:1, q=0:1, P=0:2, Q=0:1)
df <- cbind(df, AICc=NA)
# Compute AICc:
for (i in 1:nrow(df)) {
sarima.obj <- NULL
try(arima.obj <- arima(wine.bc, order=c(df$p[i], 0, df$q[i]),seasonal=list(order=c(df$P[i], 1, df$Q[i]),period=12),method="ML"))
if (!is.null(arima.obj)) { df$AICc[i] <- AICc(arima.obj) }
# print(df[i, ])
}
library(qpcR)
# Candidate models:
df <- expand.grid(p=0:1, q=0:1, P=0:2, Q=0:1)
df <- cbind(df, AICc=NA)
# Compute AICc:
for (i in 1:nrow(df)) {
sarima.obj <- NULL
try(arima.obj <- arima(wine.bc, order=c(df$p[i], 0, df$q[i]),seasonal=list(order=c(df$P[i], 1, df$Q[i]),period=12),method="ML"))
if (!is.null(arima.obj)) { df$AICc[i] <- AICc(arima.obj) }
# print(df[i, ])
}
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(qpcR)
install.packages("qpcR")
install.packages("rgl")
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(qpcR)
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(rgl)
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(qpcR)
# Candidate models:
df <- expand.grid(p=0:1, q=0:1, P=0:2, Q=0:1)
df <- cbind(df, AICc=NA)
# Compute AICc:
for (i in 1:nrow(df)) {
sarima.obj <- NULL
try(arima.obj <- arima(wine.bc, order=c(df$p[i], 0, df$q[i]),seasonal=list(order=c(df$P[i], 1, df$Q[i]),period=12),method="ML"))
if (!is.null(arima.obj)) { df$AICc[i] <- AICc(arima.obj) }
# print(df[i, ])
}
setwd("/Users/xuao/Documents/PSTAT296A/pstat296")
library(tsdl)
library(forecast)
library(MASS)
library(GeneCycle)
library(qpcR)
