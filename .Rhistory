# Divide it into train and test for nearly 90% and 10%
train <- Govt_20_Yield$yield_percentage[709:1116]
test <- Govt_20_Yield$yield_percentage[1117:1161]
#train set contains data points from 1986.01 to 2018.12, 408 points totally
#test set contains data points from 2019.01 and 2022.9, 45 points totally
# Since there is a big difference between the time before index 709 (1985.01) and after that
# So we choose to research in the data after index 709
# Divide it into train and test for nearly 90% and 10%
train <- Govt_20_Yield$yield_percentage[709:1116]
test <- Govt_20_Yield$yield_percentage[1117:1161]
#train set contains data points from 1985.01 to 2018.12, 408 points totally
#test set contains data points from 2019.01 and 2022.9, 45 points totally
par(mfrow=c(2, 1))
tsdata <- ts(train, frequency = 12, start = c(1985,1,1))
c_test <-ts(test,start = c(2019,1),frequency = 12)
ts.plot(tsdata)
#ts.plot(c_test)
hist(tsdata, main="Histogram",
xlab="date")
acf(train, lag.max = 40, main = "")
# Box-Cox transformation:
t <- 1:length(tsdata)
bcTransform <- boxcox(tsdata ~ t, plotit=TRUE)
lambda <- bcTransform$x[which.max(bcTransform$y)]
tsdata.bc = (1/lambda)*(tsdata^lambda-1)
lambda
plot(tsdata.bc)
hist(tsdata, main="Histogram",
xlab="date")
acf(train, lag.max = 40, main = "")
# Box-Cox transformation:
t <- 1:length(tsdata)
bcTransform <- boxcox(tsdata ~ t, plotit=TRUE)
lambda <- bcTransform$x[which.max(bcTransform$y)]
tsdata.bc = (1/lambda)*(tsdata^lambda-1)
lambda
plot(tsdata.bc)
# Plot and compare the two:
par(mfrow=c(2,3))
plot.ts(tsdata,xlab = "", main = "")
hist(tsdata, col = "light blue", xlab = "", main = "")
qqnorm(tsdata, main = "", xlab = "")
qqline(tsdata, col = "red")
plot.ts(tsdata.bc,xlab = "", main = "")
hist(tsdata.bc, col = "light blue", xlab = "", main = "")
qqnorm(tsdata.bc, main = "", xlab = "")
qqline(tsdata.bc, col = "red")
#y1 <- ts(as.ts(train),frequency = 12)
decomp <- decompose(tsdata.bc)
plot(decomp)
# Deseasonlize:
tsdata.bc.12 <- diff(tsdata.bc, 12)
tsdata.bc.12.1 <- diff(tsdata.bc.12, 1)
tsdata.bc.12.1.1 <- diff(tsdata.bc.12.1, 1)
var(tsdata.bc)
var(tsdata.bc.12);
var(tsdata.bc.12.1);
var(tsdata.bc.12.1.1)
# Plot it for De-seasonlized Time Series :
par(mfrow=c(1, 1))
ts.plot(tsdata.bc.12.1, main="De-seasonlized Time Series",
ylab=expression(nabla[1]~nabla[12]~Y[t]))
abline(h=mean(tsdata.bc.12.1), lty=2)
# Compare the ACF and PACF of tsdata, tsdata.12, and tsdata.1.12
par(mfrow=c(2,3))
#acf(train, lag.max = 60, main = expression(U[t]))
#acf(tsdata.12, lag.max = 60, main = expression(nabla[12]~~U[t]))
acf(tsdata.bc.12.1, lag.max = 60, main = expression(nabla[1]~nabla[12]~~U[t]))
#pacf(train, lag.max = 60, main = "")
#pacf(tsdata.12, lag.max = 60, main = "")
pacf(tsdata.bc.12.1, lag.max = 60, main = "")
# Calculate the AICc of possible models
a1 <- AICc(arima(tsdata.bc, order = c(0,1,0),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
a2 <- AICc(arima(tsdata.bc, order = c(0,1,0),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
a3 <- AICc(arima(tsdata.bc, order = c(0,1,0),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
a4 <- AICc(arima(tsdata.bc, order = c(0,1,0),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
a5 <- AICc(arima(tsdata.bc, order = c(0,1,1),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
a6 <- AICc(arima(tsdata.bc, order = c(0,1,1),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
a7 <- AICc(arima(tsdata.bc, order = c(0,1,1),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
a8 <- AICc(arima(tsdata.bc, order = c(0,1,1),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
a9 <- AICc(arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
a10 <- AICc(arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
a11 <- AICc(arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
a12 <- AICc(arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
b1 <- AICc(arima(tsdata.bc, order = c(1,1,0),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
b2 <- AICc(arima(tsdata.bc, order = c(1,1,0),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
#b3 <- AICc(arima(tsdata.bc, order = c(1,1,0),
#seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
b4 <- AICc(arima(tsdata.bc, order = c(1,1,0),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
b5 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
b6 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
#b7 <- AICc(arima(tsdata.bc, order = c(1,1,1),
#seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
b8 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
# Calculate the AICc of possible models
a1 <- AICc(arima(tsdata.bc, order = c(0,1,0),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
a2 <- AICc(arima(tsdata.bc, order = c(0,1,0),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
a3 <- AICc(arima(tsdata.bc, order = c(0,1,0),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
a4 <- AICc(arima(tsdata.bc, order = c(0,1,0),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
a5 <- AICc(arima(tsdata.bc, order = c(0,1,1),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
a6 <- AICc(arima(tsdata.bc, order = c(0,1,1),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
a7 <- AICc(arima(tsdata.bc, order = c(0,1,1),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
a8 <- AICc(arima(tsdata.bc, order = c(0,1,1),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
a9 <- AICc(arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
a10 <- AICc(arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
a11 <- AICc(arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
a12 <- AICc(arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
b1 <- AICc(arima(tsdata.bc, order = c(1,1,0),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
b2 <- AICc(arima(tsdata.bc, order = c(1,1,0),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
#b3 <- AICc(arima(tsdata.bc, order = c(1,1,0),
#seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
b4 <- AICc(arima(tsdata.bc, order = c(1,1,0),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
b5 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
b6 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
b7 <- AICc(arima(tsdata.bc, order = c(1,1,1),
#seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
#b8 <- AICc(arima(tsdata.bc, order = c(1,1,1),
#seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
b9 <- AICc(arima(tsdata.bc, order = c(1,1,2),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
b10 <- AICc(arima(tsdata.bc, order = c(1,1,2),
b3 <- AICc(arima(tsdata.bc, order = c(1,1,0),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
b4 <- AICc(arima(tsdata.bc, order = c(1,1,0),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
b5 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
b6 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
b7 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
b8 <- AICc(arima(tsdata.bc, order = c(1,1,1),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
#b8 <- AICc(arima(tsdata.bc, order = c(1,1,1),
#seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
b9 <- AICc(arima(tsdata.bc, order = c(1,1,2),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
b10 <- AICc(arima(tsdata.bc, order = c(1,1,2),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
#b11 <- AICc(arima(tsdata.bc, order = c(1,1,2),
#seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
#b12 <- AICc(arima(tsdata.bc, order = c(1,1,2),
#seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
c1 <- AICc(arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
c2 <- AICc(arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
c3 <- AICc(arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
c4 <- AICc(arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
c5 <- AICc(arima(tsdata.bc, order = c(2,1,1),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
c6 <- AICc(arima(tsdata.bc, order = c(2,1,1),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
c7 <- AICc(arima(tsdata.bc, order = c(2,1,1),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
c8 <- AICc(arima(tsdata.bc, order = c(2,1,1),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
c9 <- AICc(arima(tsdata.bc, order = c(2,1,2),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
c10 <- AICc(arima(tsdata.bc, order = c(2,1,2),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
c11 <- AICc(arima(tsdata.bc, order = c(2,1,2),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
c12 <- AICc(arima(tsdata.bc, order = c(2,1,2),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
b11 <- AICc(arima(tsdata.bc, order = c(1,1,2),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
#b11 <- AICc(arima(tsdata.bc, order = c(1,1,2),
#seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
b12 <- AICc(arima(tsdata.bc, order = c(1,1,2),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
c1 <- AICc(arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
c2 <- AICc(arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
c3 <- AICc(arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
c4 <- AICc(arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
c5 <- AICc(arima(tsdata.bc, order = c(2,1,1),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
c6 <- AICc(arima(tsdata.bc, order = c(2,1,1),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
c7 <- AICc(arima(tsdata.bc, order = c(2,1,1),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
c8 <- AICc(arima(tsdata.bc, order = c(2,1,1),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
c9 <- AICc(arima(tsdata.bc, order = c(2,1,2),
seasonal = list(order = c(0,1,1), period = 12), method = "ML"))
c10 <- AICc(arima(tsdata.bc, order = c(2,1,2),
seasonal = list(order = c(0,1,3), period = 12), method = "ML"))
c11 <- AICc(arima(tsdata.bc, order = c(2,1,2),
seasonal = list(order = c(2,1,1), period = 12), method = "ML"))
c12 <- AICc(arima(tsdata.bc, order = c(2,1,2),
seasonal = list(order = c(2,1,3), period = 12), method = "ML"))
AICc_value <- rbind(a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,b1,b2,b4,b5,b6,b9,b10,b12,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12)
#AICc_value
AICc_value[which.min(AICc_value), ]
m1 <-
AICc_value2 <- rbind(a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,b1,b2,b4,b5,b6,b8,b9,b10,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12)
AICc_value2[which.min(AICc_value2), ]
arima(tsdata.bc, order = c(2,1,0), seasonal = list(order = c(0,1,1), period = 12), method = "ML")
arima(tsdata.bc, order = c(2,1,0), seasonal = list(order = c(0,1,1), period = 12), method = "ML")
polyroot(c(1, 0.0283))
polyroot(c(1, 0.0283))
# Plot the residuals
fit1 <- arima(tsdata.bc, order = c(2,1,0),
seasonal = list(order = c(0,1,1), period = 12), method = "ML")
res1 <- residuals(fit1)
plot.ts(res1, xlab = "")
abline(h=mean(res1),col = "blue")
# Plot the histogram, Q-Q normal plot of the residual par(mfrow=c(1,2))
hist(res1, density = 20, breaks = 20,
col = "blue", xlab = "", prob = TRUE, main = "")
m1 <- mean(res1)
std1 <- sqrt(var(res1))
curve(dnorm(x,m1,std1),add = TRUE)
qqnorm(res1,main = "", xlab = "")
qqline(res1, col = "blue")
# Plot the ACF and PACF of the residual
par(mfrow=c(1,2))
acf(res1,lag.max=60, main = "")
pacf(res1,lag.max=60, main = "")
arima(tsdata.bc, order = c(0,1,2), seasonal = list(order = c(0,1,1), period = 12), method = "ML")
polyroot(c(1, 0.0430))
# Plot the residuals
fit2 <- arima(tsdata.bc, order = c(0,1,2),
seasonal = list(order = c(0,1,1), period = 12), method = "ML")
res2 <- residuals(fit2)
plot.ts(res2, xlab = "")
abline(h=mean(res2),col = "blue")
# Plot the histogram, Q-Q normal plot of the residual par(mfrow=c(1,2))
hist(res1, density = 20, breaks = 20,
col = "blue", xlab = "", prob = TRUE, main = "")
m2 <- mean(res2)
std2 <- sqrt(var(res2))
curve(dnorm(x,m2,std2),add = TRUE)
qqnorm(res2,main = "", xlab = "")
qqline(res2, col = "blue")
# Plot the ACF and PACF of the residual
par(mfrow=c(1,2))
acf(res2,lag.max=60, main = "")
pacf(res2,lag.max=60, main = "")
# Residual plots:
res1 <- residuals(fit1)
mean(res1); var(res1)
# layout(matrix(c(1, 1, 2, 3), 2, 2, byrow=T))
par(mfrow=c(1, 1))
ts.plot(res1, main="Fitted Residuals")
t1 <- 1:length(res1)
fit.res1 = lm(res1~ t1)
abline(fit.res1)
abline(h = mean(res1), col = "red")
# ACF and PACF:
par(mfrow=c(1, 2))
acf(res1, main="Autocorrelation")
pacf(res1, main="Partial Autocorrelation")
Box.test(res1, lag = 14, type = c("Box-Pierce"), fitdf = 1)
Box.test(res1, lag = 14, type = c("Ljung-Box"), fitdf = 1)
Box.test(res1^2, lag = 14, type = c("Ljung-Box"), fitdf = 1)
shapiro.test(res1)
# Histogram and QQ-plot:
par(mfrow=c(1,2))
hist(res1,main = "Histogram")
qqnorm(res1)
qqline(res1,col ="blue")
# Residual plots:
res2 <- residuals(fit2)
mean(res2); var(res2)
# layout(matrix(c(1, 1, 2, 3), 2, 2, byrow=T))
par(mfrow=c(1, 1))
ts.plot(res2, main="Fitted Residuals")
t2 <- 1:length(res2)
fit.res2 = lm(res2~ t2)
abline(fit.res2)
abline(h = mean(res2), col = "red")
# ACF and PACF:
par(mfrow=c(1, 2))
acf(res2, main="Autocorrelation")
pacf(res2, main="Partial Autocorrelation")
Box.test(res2, lag = 14, type = c("Box-Pierce"), fitdf = 1)
Box.test(res2, lag = 14, type = c("Ljung-Box"), fitdf = 1)
Box.test(res2, lag = 14, type = c("Box-Pierce"), fitdf = 1)
Box.test(res2, lag = 14, type = c("Ljung-Box"), fitdf = 1)
Box.test(res2^2, lag = 14, type = c("Ljung-Box"), fitdf = 1)
ar(res2,aic=TRUE,order.max=NULL, mehod = c("yule-walker"))
ar(res1,aic=TRUE,order.max=NULL, mehod = c("yule-walker"))
par(mfrow=c(2, 1))
tsdata <- ts(train, frequency = 12, start = c(1985,1,1))
c_test <-ts(test,start = c(2019,1),frequency = 12)
ts.plot(tsdata)
#ts.plot(c_test)
hist(tsdata, main="Histogram",
xlab="date")
acf(train, lag.max = 40, main = "")
# Box-Cox transformation:
t <- 1:length(tsdata)
bcTransform <- boxcox(tsdata ~ t, plotit=TRUE)
lambda <- bcTransform$x[which.max(bcTransform$y)]
tsdata.bc = (1/lambda)*(tsdata^lambda-1)
lambda
plot(tsdata.bc)
# Box-Cox transformation:
t <- 1:length(tsdata)
bcTransform <- boxcox(tsdata ~ t, plotit=TRUE)
lambda <- bcTransform$x[which.max(bcTransform$y)]
tsdata.bc = (1/lambda)*(tsdata^lambda-1)
lambda
plot(tsdata.bc)
# Plot and compare the two:
par(mfrow=c(2,3))
plot.ts(tsdata,xlab = "", main = "")
hist(tsdata, col = "light blue", xlab = "", main = "")
qqnorm(tsdata, main = "", xlab = "")
qqline(tsdata, col = "red")
plot.ts(tsdata.bc,xlab = "", main = "")
hist(tsdata.bc, col = "light blue", xlab = "", main = "")
qqnorm(tsdata.bc, main = "", xlab = "")
qqline(tsdata.bc, col = "red")
#y1 <- ts(as.ts(train),frequency = 12)
decomp <- decompose(tsdata.bc)
plot(decomp)
# Deseasonlize:
tsdata.bc.12 <- diff(tsdata.bc, 12)
tsdata.bc.12.1 <- diff(tsdata.bc.12, 1)
tsdata.bc.12.1.1 <- diff(tsdata.bc.12.1, 1)
var(tsdata.bc)
var(tsdata.bc.12);
var(tsdata.bc.12.1);
var(tsdata.bc.12.1.1)
# Plot it for De-seasonlized Time Series :
par(mfrow=c(1, 1))
ts.plot(tsdata.bc.12.1, main="De-seasonlized Time Series",
ylab=expression(nabla[1]~nabla[12]~Y[t]))
abline(h=mean(tsdata.bc.12.1), lty=2)
library(forecast)
#auto.arima(tsdata.1.12,ic = c("aicc"),seasonal = T,stepwise = F,parallel = T)
library(forecast)
auto.arima(tsdata.12.1,ic = c("aicc"),seasonal = T,stepwise = F,parallel = T)
library(forecast)
auto.arima(tsdata.bc.12.1,ic = c("aicc"),seasonal = T,stepwise = F,parallel = T)
# Box-Cox transformation:
t <- 1:length(tsdata)
bcTransform <- boxcox(tsdata ~ t, plotit=TRUE)
lambda <- bcTransform$x[which.max(bcTransform$y)]
tsdata.bc = (1/lambda)*(tsdata^lambda-1)
lambda
plot(tsdata.bc)
#y1 <- ts(as.ts(train),frequency = 12)
decomp <- decompose(tsdata.bc)
plot(decomp)
# Deseasonlize:
tsdata.bc.12 <- diff(tsdata.bc, 12)
tsdata.bc.12.1 <- diff(tsdata.bc.12, 1)
tsdata.bc.12.1.1 <- diff(tsdata.bc.12.1, 1)
var(tsdata.bc)
var(tsdata.bc.12);
var(tsdata.bc.12.1);
var(tsdata.bc.12.1.1)
# Plot it for De-seasonlized Time Series :
par(mfrow=c(1, 1))
ts.plot(tsdata.bc.12.1, main="De-seasonlized Time Series",
ylab=expression(nabla[1]~nabla[12]~Y[t]))
abline(h=mean(tsdata.bc.12.1), lty=2)
library(forecast)
auto.arima(tsdata.bc.12.1,ic = c("aicc"),seasonal = T,stepwise = F,parallel = T)
AICc_value <- rbind(a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,b1,b2,b4,b5,b6,b9,b10,b12,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12)
#AICc_value
AICc_value[which.min(AICc_value), ]
m1 <-
AICc_value2 <- rbind(a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,b1,b2,b4,b5,b6,b8,b9,b10,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12)
AICc_value2[which.min(AICc_value2), ]
arima(tsdata.bc, order = c(2,1,0), seasonal = list(order = c(0,1,1), period = 12), method = "ML")
polyroot(c(1, 0.0283))
sqrt(length(train))
Box.test(res1, lag = 20, type = c("Box-Pierce"), fitdf = 18)
Box.test(res1, lag = 20, type = c("Box-Pierce"), fitdf = 2)
Box.test(res1, lag = 14, type = c("Ljung-Box"), fitdf = 2)
Box.test(res1, lag = 20, type = c("Ljung-Box"), fitdf = 2)
Box.test(res1^2, lag = 20, type = c("Ljung-Box"), fitdf = 0)
ar(res1,aic=TRUE,order.max=NULL, mehod = c("yule-walker"))
shapiro.test(res1)
# Residual plots:
res2 <- residuals(fit2)
mean(res2); var(res2)
# layout(matrix(c(1, 1, 2, 3), 2, 2, byrow=T))
par(mfrow=c(1, 1))
ts.plot(res2, main="Fitted Residuals")
t2 <- 1:length(res2)
fit.res2 = lm(res2~ t2)
abline(fit.res2)
abline(h = mean(res2), col = "red")
Box.test(res2, lag = 20, type = c("Box-Pierce"), fitdf = 2)
Box.test(res2, lag = 20, type = c("Ljung-Box"), fitdf = 2)
Box.test(res2^2, lag = 20, type = c("Ljung-Box"), fitdf = 0)
ar(res2,aic=TRUE,order.max=NULL, mehod = c("yule-walker"))
shapiro.test(res2)
# Histogram and QQ-plot:
par(mfrow=c(1,2))
hist(res2,main = "Histogram")
qqnorm(res2)
qqline(res2,col ="blue")
fit.1<-arima(tsdata, order = c(2,1,0),
seasonal = list(order = c(0,1,1), period = 12), method = "ML")
# Create confidence interval
pred.tr <- predict(fit.1, n.ahead = 93)
U.tr = pred.tr$pred + 2*pred.tr$se
L.tr = pred.tr$pred - 2*pred.tr$se
# Forecast on original data
plot.ts(tsdata, xlim = c(1984,2022), ylim = c(0,13))
lines(U.tr, col = "blue", lty = "dashed")
lines(L.tr, col = "blue", lty = "dashed")
points(pred.tr$pred,col = "red", pch = 1)
# Zoom in graph
par(mfrow=c(1,2))
plot.ts(tsdata, xlim = c(2015,2022), ylim = c(0,max(U.tr)))
lines(U.tr, col = "blue", lty = "dashed")
lines(L.tr, col = "blue", lty = "dashed")
points(pred.tr$pred,col = "red", pch = 1)
legend("bottomright", c("Prediction","95% C.I."),
fill = c("red", "blue"), cex = 1.25)
# Zoom in graph
par(mfrow=c(1,2))
plot.ts(tsdata, xlim = c(2015,2022), ylim = c(0,max(U.tr)))
lines(U.tr, col = "blue", lty = "dashed")
lines(L.tr, col = "blue", lty = "dashed")
points(pred.tr$pred,col = "red", pch = 1)
# Forecast with test dataset
plot.ts(co2, xlim = c(1988,1991), ylim = c(340,max(U.tr)))
lines(U.tr, col = "blue", lty = "dashed")
lines(L.tr, col = "blue", lty = "dashed")
points(pred.tr$pred,col = "red", pch = 1)
points(test,col = "slategrey", pch = 20)
legend("bottomright", c("Prediction","95% C.I.","c_test"),
fill = c("red", "blue","slategrey"), cex = 1.25)
# Zoom in graph
par(mfrow=c(1,2))
plot.ts(tsdata, xlim = c(2015,2022), ylim = c(1,5)
lines(U.tr, col = "blue", lty = "dashed")
# Zoom in graph
par(mfrow=c(1,2))
plot.ts(tsdata, xlim = c(2015,2022), ylim = c(1,5)
lines(U.tr, col = "blue", lty = "dashed")
# Zoom in graph
par(mfrow=c(1,2))
plot.ts(tsdata, xlim = c(2015,2022), ylim = c(1,5))
lines(U.tr, col = "blue", lty = "dashed")
lines(L.tr, col = "blue", lty = "dashed")
points(pred.tr$pred,col = "red", pch = 1)
# Forecast with test dataset
plot.ts(co2, xlim = c(2015,2022), ylim = c(1,5))
lines(U.tr, col = "blue", lty = "dashed")
lines(L.tr, col = "blue", lty = "dashed")
points(pred.tr$pred,col = "red", pch = 1)
points(test,col = "slategrey", pch = 20)
# Forecast with test dataset
plot.ts(c_train, xlim = c(2015,2022), ylim = c(1,5))
# Forecast with test dataset
plot.ts(c_test, xlim = c(2015,2022), ylim = c(1,5))
lines(U.tr, col = "blue", lty = "dashed")
lines(L.tr, col = "blue", lty = "dashed")
points(pred.tr$pred,col = "red", pch = 1)
points(test,col = "slategrey", pch = 20)
# Plot the histogram, Q-Q normal plot of the residual par(mfrow=c(1,2))
hist(res1, density = 20, breaks = 20,
col = "blue", xlab = "", prob = TRUE, main = "")
m1 <- mean(res1)
std1 <- sqrt(var(res1))
curve(dnorm(x,m1,std1),add = TRUE)
qqnorm(res1,main = "", xlab = "")
qqline(res1, col = "blue")
# Plot the ACF and PACF of the residual
par(mfrow=c(1,2))
acf(res1,lag.max=120, main = "")
pacf(res1,lag.max=120, main = "")
